<!DOCTYPE HTML>
<html lang="ru" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Часть 1 - Linux for ARM</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../././mdbook-admonish.css">
        <link rel="stylesheet" href="../././1.css">
        <link rel="stylesheet" href=".././mdbook-admonish.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Linux for ARM</a></li><li class="chapter-item expanded affix "><a href="../foreword.html">Предисловие</a></li><li class="chapter-item expanded affix "><a href="../from-authors.html">От авторов</a></li><li class="chapter-item expanded affix "><a href="../benefits.html">Преимущества</a></li><li class="chapter-item expanded affix "><a href="../before-start.html">Прежде чем начать</a></li><li class="chapter-item expanded affix "><a href="../typography.html">Принятые обозначения</a></li><li class="chapter-item expanded affix "><a href="../inaccuracies.html">Опечатки и неточности</a></li><li class="chapter-item expanded affix "><a href="../arch.html">Целевая архитектура</a></li><li class="chapter-item expanded affix "><a href="../software.html">Информация об используемом ПО</a></li><li class="chapter-item expanded "><a href="../prepare/index.html"><strong aria-hidden="true">1.</strong> Подготовка к сборке</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../prepare/requrements.html"><strong aria-hidden="true">1.1.</strong> Требования к хосту</a></li><li class="chapter-item expanded "><a href="../prepare/about-sbu.html"><strong aria-hidden="true">1.2.</strong> О времени сборки пакетов</a></li><li class="chapter-item expanded "><a href="../prepare/add-user.html"><strong aria-hidden="true">1.3.</strong> Создание пользователя lfa</a></li><li class="chapter-item expanded "><a href="../prepare/set-env.html"><strong aria-hidden="true">1.4.</strong> Настройка окружения</a></li><li class="chapter-item expanded "><a href="../prepare/set-build-env.html"><strong aria-hidden="true">1.5.</strong> Установка переменных сборки</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../prepare/set-build-env-aarch64.html"><strong aria-hidden="true">1.5.1.</strong> Для архитектуры AArch64</a></li><li class="chapter-item expanded "><a href="../prepare/set-build-env-other.html"><strong aria-hidden="true">1.5.2.</strong> Для других архитектур</a></li></ol></li><li class="chapter-item expanded "><a href="../prepare/create-dirs.html"><strong aria-hidden="true">1.6.</strong> Создание основных каталогов</a></li><li class="chapter-item expanded "><a href="../prepare/download-packages.html"><strong aria-hidden="true">1.7.</strong> Скачивание пакетов</a></li></ol></li><li class="chapter-item expanded "><a href="../cross-compiler/index.html"><strong aria-hidden="true">2.</strong> Сборка кросс-компилятора</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cross-compiler/linux-headers.html"><strong aria-hidden="true">2.1.</strong> linux-headers</a></li><li class="chapter-item expanded "><a href="../cross-compiler/binutils.html"><strong aria-hidden="true">2.2.</strong> binutils</a></li><li class="chapter-item expanded "><a href="../cross-compiler/gcc-p1.html"><strong aria-hidden="true">2.3.</strong> gcc (проход 1)</a></li><li class="chapter-item expanded "><a href="../cross-compiler/musl.html"><strong aria-hidden="true">2.4.</strong> musl</a></li><li class="chapter-item expanded "><a href="../cross-compiler/gcc-p2.html"><strong aria-hidden="true">2.5.</strong> gcc (проход 2)</a></li><li class="chapter-item expanded "><a href="../cross-compiler/check.html"><strong aria-hidden="true">2.6.</strong> Проверка кросс-компилятора</a></li><li class="chapter-item expanded "><a href="../cross-compiler/cleanup.html"><strong aria-hidden="true">2.7.</strong> Очистка и сохранение</a></li><li class="chapter-item expanded "><a href="../cross-compiler/env.html"><strong aria-hidden="true">2.8.</strong> Объявление дополнительных переменных</a></li></ol></li><li class="chapter-item expanded "><a href="../base/index.html"><strong aria-hidden="true">3.</strong> Сборка базовой системы</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../base/create-files.html"><strong aria-hidden="true">3.1.</strong> Создание файлов и каталогов</a></li><li class="chapter-item expanded "><a href="../base/libgcc.html"><strong aria-hidden="true">3.2.</strong> libgcc</a></li><li class="chapter-item expanded "><a href="../base/musl.html"><strong aria-hidden="true">3.3.</strong> musl</a></li><li class="chapter-item expanded "><a href="../base/busybox.html"><strong aria-hidden="true">3.4.</strong> busybox</a></li><li class="chapter-item expanded "><a href="../base/iana-etc.html"><strong aria-hidden="true">3.5.</strong> iana-etc</a></li><li class="chapter-item expanded "><a href="../base/wireless-tools.html"><strong aria-hidden="true">3.6.</strong> wireless-tools</a></li></ol></li><li class="chapter-item expanded "><a href="../set-base/index.html"><strong aria-hidden="true">4.</strong> Настройка базовой системы</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../set-base/fstab.html"><strong aria-hidden="true">4.1.</strong> Создание /etc/fstab</a></li><li class="chapter-item expanded "><a href="../set-base/mdev.html"><strong aria-hidden="true">4.2.</strong> Настройка mdev</a></li><li class="chapter-item expanded "><a href="../set-base/profile.html"><strong aria-hidden="true">4.3.</strong> Создание /etc/profile</a></li><li class="chapter-item expanded "><a href="../set-base/hostname.html"><strong aria-hidden="true">4.4.</strong> Установка имени хоста</a></li><li class="chapter-item expanded "><a href="../set-base/network.html"><strong aria-hidden="true">4.5.</strong> Настройка сети</a></li></ol></li><li class="chapter-item expanded "><a href="../kernel/index.html"><strong aria-hidden="true">5.</strong> Сборка ядра</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../kernel/linux.html"><strong aria-hidden="true">5.1.</strong> linux</a></li></ol></li><li class="chapter-item expanded "><a href="../bootloader/index.html"><strong aria-hidden="true">6.</strong> Сборка загрузчика</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bootloader/allwinner.html"><strong aria-hidden="true">6.1.</strong> Allwinner</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bootloader/allwinner-tf-a.html"><strong aria-hidden="true">6.1.1.</strong> Сборка TF-A</a></li><li class="chapter-item expanded "><a href="../bootloader/allwinner-or2k-cc.html"><strong aria-hidden="true">6.1.2.</strong> Установка кросс-компилятора or2k</a></li><li class="chapter-item expanded "><a href="../bootloader/allwinner-crust.html"><strong aria-hidden="true">6.1.3.</strong> Сборка SCP (crust)</a></li><li class="chapter-item expanded "><a href="../bootloader/allwinner-uboot.html"><strong aria-hidden="true">6.1.4.</strong> Сборка U-Boot</a></li></ol></li><li class="chapter-item expanded "><a href="../bootloader/broadcom.html"><strong aria-hidden="true">6.2.</strong> Broadcom</a></li><li class="chapter-item expanded "><a href="../bootloader/rockchip.html"><strong aria-hidden="true">6.3.</strong> Rockchip</a></li><li class="chapter-item expanded "><a href="../bootloader/qemu.html"><strong aria-hidden="true">6.4.</strong> Эмуляция в QEMU (ARM)</a></li></ol></li><li class="chapter-item expanded "><a href="../boot-files/index.html"><strong aria-hidden="true">7.</strong> Создание прочих загрузочных файлов</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../boot-files/bootscripts.html"><strong aria-hidden="true">7.1.</strong> Загрузочные скрипты</a></li><li class="chapter-item expanded "><a href="../boot-files/uInitrd.html"><strong aria-hidden="true">7.2.</strong> Создание uInitrd</a></li><li class="chapter-item expanded "><a href="../boot-files/boot.scr.html"><strong aria-hidden="true">7.3.</strong> Создание boot.scr</a></li></ol></li><li class="chapter-item expanded "><a href="../create-img.html"><strong aria-hidden="true">8.</strong> Сборка образа</a></li><li class="chapter-item expanded "><a href="../next.html"><strong aria-hidden="true">9.</strong> Что далее?</a></li><li class="chapter-item expanded "><a href="../additional/index.html"><strong aria-hidden="true">10.</strong> Вспомогательные материалы</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../additional/arm.html"><strong aria-hidden="true">10.1.</strong> Процессоры ARM</a></li><li class="chapter-item expanded "><a href="../additional/os-structure.html"><strong aria-hidden="true">10.2.</strong> Заметки об ОС Linux</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../additional/os-structure1.html" class="active"><strong aria-hidden="true">10.2.1.</strong> Часть 1</a></li><li class="chapter-item expanded "><a href="../additional/os-structure2.html"><strong aria-hidden="true">10.2.2.</strong> Часть 2</a></li><li class="chapter-item expanded "><a href="../additional/os-structure3.html"><strong aria-hidden="true">10.2.3.</strong> Часть 3</a></li><li class="chapter-item expanded "><a href="../additional/os-structure4.html"><strong aria-hidden="true">10.2.4.</strong> Часть 4</a></li></ol></li><li class="chapter-item expanded "><a href="../additional/pkgmgt.html"><strong aria-hidden="true">10.3.</strong> Управление пакетами</a></li><li class="chapter-item expanded "><a href="../additional/compile.html"><strong aria-hidden="true">10.4.</strong> Сборка ПО из исходного кода</a></li><li class="chapter-item expanded "><a href="../additional/cross-compiler.html"><strong aria-hidden="true">10.5.</strong> Кросс-компилятор</a></li><li class="chapter-item expanded "><a href="../additional/fpu.html"><strong aria-hidden="true">10.6.</strong> FPU в ARM-процессорах</a></li><li class="chapter-item expanded "><a href="../additional/dtb.html"><strong aria-hidden="true">10.7.</strong> Device Tree</a></li></ol></li><li class="chapter-item expanded "><a href="../appendix/index.html"><strong aria-hidden="true">11.</strong> Приложения</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../appendix/computers.html"><strong aria-hidden="true">11.1.</strong> Список ПК, на которых собиралась LFA</a></li><li class="chapter-item expanded "><a href="../appendix/scripts/index.html"><strong aria-hidden="true">11.2.</strong> Загрузочные скрипты и конфигурационные файлы</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../appendix/scripts/rc.d-shutdown.html"><strong aria-hidden="true">11.2.1.</strong> /etc/rc.d/shutdown</a></li><li class="chapter-item expanded "><a href="../appendix/scripts/rc.d-startup.html"><strong aria-hidden="true">11.2.2.</strong> /etc/rc.d/startup</a></li><li class="chapter-item expanded "><a href="../appendix/scripts/rc.d-init.d-functions.html"><strong aria-hidden="true">11.2.3.</strong> /etc/rc.d/init.d/functions</a></li><li class="chapter-item expanded "><a href="../appendix/scripts.rc.d-scripts.html"><strong aria-hidden="true">11.2.4.</strong> /etc/rc.d/init.d/scripts/</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../literature.html"><strong aria-hidden="true">12.</strong> Литература</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../roadmap.html"><strong aria-hidden="true">13.</strong> Roadmap</a></li><li class="chapter-item expanded "><a href="../whatsnew.html"><strong aria-hidden="true">14.</strong> Что нового в этом релизе</a></li><li class="chapter-item expanded "><a href="../changelog.html"><strong aria-hidden="true">15.</strong> Список изменений</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linux for ARM</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/linux-for-arm/handbook" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/linux-for-arm/handbook/edit/master/md/additional/os-structure1.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="Заметки-об-ОС-linux-Часть-1-Обзор"><a class="header" href="#Заметки-об-ОС-linux-Часть-1-Обзор">Заметки об ОС Linux. Часть 1. Обзор</a></h1>
<h2 id="Операционные-системы"><a class="header" href="#Операционные-системы">Операционные системы</a></h2>
<p>Определение, что же такое ОС, весьма объёмно и всеобъемлюще. Но вкратце можно сказать о том, что операционная система — это программное обеспечение, управляющее аппаратным обеспечением компьютера и предоставляющее какие-либо абстракции для остального прикладного ПО, которое запускается на компьютере. Примером таких абстракций можно назвать файл на жёстком диске: компьютер сам по себе не знает, что такое файл, ровно как и на жёстком диске или ином носителе информации у нас содержится последовательность данных, которую мы не можем назвать «файлом» в привычном для нас смысле этого слова. Уже операционная система предоставляет пользователю (и программисту, и программам, запускающимся на этой ОС) такую абстракцию, которая «преобразует» эти данные на жёстком диске в привычные нам файлы и папки.</p>
<p>В широком смысле под операционной системой подразумевается совокупность ядра и работающих поверх него программ и утилит.</p>
<h3 id="Встраиваемые-embedded-системы"><a class="header" href="#Встраиваемые-embedded-системы">Встраиваемые (embedded) системы</a></h3>
<p>LFA основана на руководстве CLFS Embedded, в котором приведены сведения по сборке встраиваемой системы для архитектуры ARM. Поэтому неудивительно, что прямо сейчас описываются именно встраиваемые операционные системы. Встраиваемая ОС (Embedded OS) — такая ОС, которая работает, будучи встроенной непосредственно в девайс, которым она управляет. Т.е. это часть специализированного устройства или платформы, такой как, например устройство бытовой электроники или часть из системы умного дома.</p>
<p>Встроенный компьютер отличается от персонального тем, что встроенная система как правило спроектирована для одной или нескольких конкретных целей, в то время как ПК предназначены для выполнения широкого круга задач. Встроенный компьютер может иметь минимально возможную для выполнения конкретной задачи производительностью, что обеспечивает лёгкую и эффективную компьютерную платформу.</p>
<h3 id="Семейство-unix"><a class="header" href="#Семейство-unix">Семейство Unix</a></h3>
<p>Среди современных операционных систем наиболее распространены два семейства: семейство операционных систем Windows и семейство операционных систем Unix. ОС семейства UNIX нашли применение на суперкомпьютерах, серверах, встраиваемых системах, мобильных устройствах, а с недавнего времени проникают и в сегмент компьютеров для обычных пользователей или офисного плангтона.</p>
<p>Unix — это семейство переносимых, многозадачных и многопользовательских систем. Главная особенность таких систем заключается в том, что это <em>изначально</em> многопользовательские и многозадачные ОС, а также такие ОС созданы таким образом, чтобы их было легко переносить с одной процессорной архитектуры на другую. Модульная структура ОС этого семейства наряду с поддержкой широкого спектра микропроцессоров и других типов оборудования сделала такие ОС достаточно популярными и во встраиваемых решениях.</p>
<p>К семейству Unix относятся многие ОС, например FreeBSD, OpenBSD, NetBSD, macOS X (версии 10.+), minix и другие. Кроме того, к этому семейству, пусть и косвенно (поскольку они не основаны на исходном коде оригинальной UNIX или какого-то из её ответвлений), относятся и ОС, использующие ядро Linux.</p>
<h2 id="ОС-использующие-ядро-linux"><a class="header" href="#ОС-использующие-ядро-linux">ОС, использующие ядро Linux</a></h2>
<p>Linux — это монолитное ядро операционной системы, распространяемое как свободное ПО на условиях лицензии GNU GPL (кроме несвободных компонентов, включая драйверы, использующие прошивки, распространяемые под другими лицензиями). Linux можно назвать «сердцем» любой ОС, описываемой в данном руководстве, в том числе это «сердце» и собранного по этому руководству дистрибутива LFA.</p>
<p>Полноценная ОС не может существовать только из одного ядра, тк ей нужны программы, предназначенные для обеспечения работы и взаимодействия с этой ОС: стандартная библиотека языка С (glibc, musl, bionic, etc.), <a href="os-structure2.html">загрузчик ОС</a> (GRUB, systemd-boot, syslinux, U-Boot), <a href="os-structure3.html">система инициализации</a> (SysVInit, OpenRC, Runit, upstart, systemd) и набор <a href="os-structure4.html">стандартных утилит</a> для работы с компонентами этой ОС (работа с файлами, правами доступа, процессами, пользователями, группами пользователей и т.п., обычно такие утилиты называются «coreutils»: GNU coreutils, uutils coreutils, etc.).</p>
<h3 id="Свободное-ПО"><a class="header" href="#Свободное-ПО">Свободное ПО</a></h3>
<p>Операционная система, использующая ядро Linux, а также все её системные компоненты и большинство её пользовательских приложений — свободные программы. Свободное ПО отличается от несвободного тем, что его можно:</p>
<ul>
<li>запускать на любом количестве компьютеров без всевозможных лицензионных ограничений;</li>
<li>распространять бесплатно или за деньги без каких-либо ограничений;</li>
</ul>
<p>Кроме того, пользователи могут получать исходный код свободного ПО, изучать и модифицировать его, а также распространять модифицированные копии такого ПО.</p>
<h3 id="Разработка-ОС-с-ядром-linux"><a class="header" href="#Разработка-ОС-с-ядром-linux">Разработка ОС с ядром Linux</a></h3>
<p>В отличие от распространённых несвободных ОС вроде Windows или macOS, Linux не имеет географического центра разработки, ровно как нет конкретной фирмы или компании, владеющей Linux, нет и единого координационного центра разработки. Эта ОС — результат работы тысячи программистов по всему миру<sup class="footnote-reference"><a href="#1">1</a></sup>.</p>
<h2 id="Компоненты-ОС-с-ядром-linux"><a class="header" href="#Компоненты-ОС-с-ядром-linux">Компоненты ОС с ядром Linux</a></h2>
<h3 id="Ядро-linux"><a class="header" href="#Ядро-linux">Ядро Linux</a></h3>
<p>Как упоминалось ранее, ядро Linux — это «сердце» операционной системы, которое, к тому же, соответствует стандарту POSIX и распространяется под лицензией GNU GPLv2. Несмотря на <em>свободную</em> лицензию, в составе ядра есть и несвободные компоненты: как правило, это драйверы, использующие несвободные прошивки и иные составляющие.</p>
<p>Linux поддерживает многозадачность, виртуальную память, динамические библиотеки и прочее, что свойственно современным операционным системам. Это монолитное ядро с поддержкой динамически загружаемых модулей. В монолитных ядрах все их компоненты (например, драйверы) как бы встроены в одно большое ядро. Это является противоположностью, например, микроядрам, где очень многие компоненты являются отдельными частями, которые не входят непосредственно в состав ядра (например, это справедливо по отношению к ядру операционной системы Minix).</p>
<p>Из плюсов монолитных ядер можно отметить более прямой доступ к аппаратным средствам, а из минусов: б<em>о</em>льший размер ядра и б<em>о</em>льшее потребление оперативной памяти. Другой минус заключается в том, что когда мы подключаем к компьютеру какое-то новое устройство, драйвер которого существует для монолитного ядра, но в данный момент он не «встроен» в это ядро (т.е. ядро не было скомпилировано с поддержкой этого драйвера), то нам придётся пересобирать ядро, включив там поддержку этого драйвера, что иногда бывает не очень удобным вариантом.</p>
<p>В итоге ядро Linux обзавелось механизмом <em>модулей</em>, которые устанавливаются в отдельный каталог (например, в <code>/lib/modules</code>). Модули мы можем подключать, когда они нам нужны, а когда необходимость их использования сойдёт на нет, их можно выгрузить.</p>
<h3 id="Загрузчик"><a class="header" href="#Загрузчик">Загрузчик</a></h3>
<p>Задача загрузчика — инициализировать и запустить ядро. На компьютерах с архитектурой ARM он может выполнять несколько больше <a href="os-structure2.html">функций</a>, но в основном всё сводится именно к инициализации и запуску ядра ОС.</p>
<h3 id="Система-инициализации"><a class="header" href="#Система-инициализации">Система инициализации</a></h3>
<p>Ядро запускает систему инициализации (<code>init</code>). В задачи <code>init</code> входит подготовка ОС к дальнейшей работе: инициализация консолей, монтирование виртуальных файловых систем и запуск компонентов системы. Процесс <code>/sbin/init</code> работает как демон и имеет <code>PID</code>=<code>1</code>.</p>
<p>Из основных реализаций системы инициализации в Linux можно отметить systemd, SysVInit, runit и OpenRC. В проекте LFA используется система инициализации из состава BusyBox.</p>
<p><code>init</code> загружается первым процессом (пользовательского режима) после инициализации ядра и отвечает за дальнейшую загрузку системы. Для этого он может либо запускать загрузочные скрипты (написанные, как правило, на BASH или каком-то другом скриптовом языке), либо читает специальные конфигурационные файлы с параметрами загрузки (такое поведение есть, например, у systemd).</p>
<p>Во многих системах Linux (особенно коммерческих) получил наибольшее распространение systemd. Это довольно удобная и функциональная система инициализации, однако некоторые пользователи критикуют её за раздутость, наличие многих ненужных пользователям функций (некоторые компоненты из systemd заменяют <code>chroot</code>, <code>cron</code> и средства для ведения логов системы), а также несколько более высокое потребление ресурсов компьютера по сравнению с другими системами инициализации. Лично для меня существенным недостатком [скорее не самог<em>о</em> systemd, а ряда программ, «прибитых» к нему] является то, что ряд ПО «прибит» к нему и работа такого ПО на системах с другими инитами может быть несколько затруднительной. Примерами такого ПО можно привести рабочие окружения GNOME и KDE. Тем не менее, systemd — довольно продвинутая система инициализации, которая не даром набрала популярность во многих дистрибутивах Linux.</p>
<h3 id="Стандартная-библиотека-языка-С"><a class="header" href="#Стандартная-библиотека-языка-С">Стандартная библиотека языка С</a></h3>
<p>Поскольку системные компоненты ОС Linux написаны преимущественно на языке программирования С, в системе присутствует стандартная библиотека этого языка, с которой динамически линкуются программы системы. Эта стандартная библиотека (<code>libc</code>) содержит системные вызовы и основные функции, которые используются в программе, например функции для работы с файлами, выделения памяти, форматирования вывода в консоль и т.д.</p>
<p>Существует множество различных стандартных библиотек С, самая распространённая из которых — GNU C Library (<code>glibc</code>). Она используется почти во всех известных дистрибутивах GNU/Linux. Однако её часто критикуют за «раздутость» и низкую скорость работы по сравнению с другими библиотеками.</p>
<p>В LFA используется стандартная библиотека С <code>musl</code>. Она была написана с нуля, без переиспользования существующего кода. При её написании уделялось внимание эффективной статической линковке программ. Эта стандартная библиотека получила распространение в минималистичных дистрибутивах Linux, например в Alpine Linux, OpenWRT и других. Применение <code>musl</code> может быть оправдано в минималистичных и встраиваемых системах, поэтому использование её в LFA в целом является хорошей идеей.</p>
<h3 id="Стандартные-утилиты-unix-coreutils"><a class="header" href="#Стандартные-утилиты-unix-coreutils">Стандартные утилиты UNIX (coreutils)</a></h3>
<p>coreutils — это набор базовых утилит операционной системы, которые включают в себя программы для управления файлами (создание, удаление, копирование и перемещение файлов и каталогов, создание ссылок и блочных файлов), правами доступа к файлам (изменение прав доступа к файлу и каталогу, смена владельца и группы файла, etc.), проверки контрольных сумм файлов, работы с текстовой информацией и т.д.</p>
<p>Во многих дистрибутивах Linux в качестве реализации стандартных утилит выступает пакет GNU Coreutils, однако кроме него есть и другие. Например, существует реализация coreutils на языке программирования Rust (<a href="https://uutils.github.io/coreutils/">uutils coreutils</a>). Во встраиваемых системах применяются более простые (а значит и более минималистичные и нетребовательные к ресурсам ПК) реализации, такие как BusyBox и ToyBox, которые объединяют все вышеописанные утилиты в один бинарный файл, имеющий размер от нескольких сотен Кбайт до 2-3 МБайт.</p>
<h3 id="Командная-оболочка-shell"><a class="header" href="#Командная-оболочка-shell">Командная оболочка (shell)</a></h3>
<p>Для того, чтобы пользователь мог взаимодействовать с операционной системой и программами, которые в неё установлены, требуется какая-либо оболочка. Это может быть либо командный интерпретатор типа <code>sh</code>, <code>ash</code>, <code>zsh</code>, <code>csh</code> или <code>bash</code>, либо графическое пользовательское окружение типа GNOME или KDE.</p>
<p>В командной оболочке пользователь может либо давать команды ОС, либо запускать файлы, в которых содержатся списки этих команд (такие файлы называются скриптами).</p>
<p>Командные оболочки позволяют не только запускать какие-либо программы и передавать этим программам нужные аргументы и значения, но также объявлять свои переменные, в которых будут содержаться определённые значения, использовать циклы, конструкции ветвления, а также использовать другие возможности, которые обычно присущи языкам программирования.</p>
<p>В операционных системах семейства Unix пользователь может использовать ветвления, циклы, функции, переменные, работать с арифметическими выражениями, сравнивать числа и строки, а также работать с текстовой информацией.</p>
<p>Эти возможности командных оболочек повсеместно используются во всех системах Unix, в том числе и дистрибутивах Linux. Начиная с процесса загрузки ОС, заканчивая какими-либо пользовательскими задачами. Преимущества Unix-оболочек используются и в этом руководстве при сборке системы.</p>
<p>Во многих дистрибутивах Linux в качестве командной оболочки используется BASH, однако во всяких минималистичных и/или встраиваемых системах можно встретить что-то вроде <code>ash</code> из состава BusyBox — микроверсию оболочки <code>sh</code>, обеспечивающую базовую функциональность shell'а. В других ОС семейства Unix можно встретить <code>csh</code> или <code>tcsh</code> (например, во FreeBSD), либо <code>zsh</code> (в macOS).</p>
<h3 id="Рабочее-окружение-desktop-environment"><a class="header" href="#Рабочее-окружение-desktop-environment">Рабочее окружение (Desktop Environment)</a></h3>
<p>Рабочее окружение — графический интерфейс в ОС семейства Unix, использующий, как правило, окна, панели, иконки и другие элементы GUI. Рабочие окружения состоят из набора различных программ, некоторые из которых разрабатываются в рамках одного проекта, а другие предоставляются сторонними разработчиками.</p>
<img src="pic/gnome.png">
<p><small>Скриншот рабочего окружения GNOME — одного из самых распространённых окружений в Linux. Имеет особую поплярность в коммерческих дистрибутивах Linux, например в Ubuntu или RHEL, но также используется и в свободных ОС, развиваемых сообществом, например в Debian GNU/Linux.</small></p>
<p>Рабочее окружение состоит из следующего ПО:</p>
<ol>
<li>Дисплейный менеджер (запрашивает аутентификационные данные нужного пользователя: его имя, пароль или отпечаток пальца, выбирает, какое рабочее окружение запустить и запускает его);</li>
<li>Оконный менеджер (управляет окнами программ);</li>
<li>Файловый менеджер (выполняет базовые действия с файлами и каталогами: просмотр содержимого директорий, переименование, перемещение, копирование, удаление файлов и директорий, создание ссылок и т.д.);</li>
<li>Панель, на которой расположены апплеты для взаимодействия с окружением (главное меню со списком приложений, часы, область уведомлений, панель управления, на которой можно изменять т.н. «быстрые параметры»: включение/выключение Wi-Fi, Bluetooth, регулировка звука и яркости экрана, кнопки для выключения/перезагрузки компьютера или выхода из текущей сессии пользователя, etc.);</li>
</ol>
<p>В Unix традиционно за обеспечение работы графических пользовательских окружений отвечает X Window System. Это сервер, обеспечивающий базовые функции графической среды: отрисовку и работу окон (их перемещение на экране, изменение размера, etc.), взаимодействие с устройствами ввода (мышь и клавиатура) и т.д. За всё остальное отвечают, как правило, оконные менеджеры, работающие поверх X и определяющие интерфейс и взаимодействие с пользователем.</p>
<p>Оконные менеджеры могут использоваться как в составе рабочего окружения, так и отдельно от него.</p>
<p>В последнее время наблюдается тенденция на отказ от X Window System в пользу протокола Wayland. Он обладает некоторыми достоинствами по сравнению с X.org (по крайней мере это не монолитный и запутанный монстр типа X.org, в котором давным-давно не разбираются даже разработчики, а вполне себе элегантная и простая вещь, вести разработку которой в разы легче и куда проще добавлять новые функции). Кроме того, Wayland не имеет присущих X недостатков и уязвимостей.</p>
<p>Вместо оконных менеджеров для Wayland применяются композитные менеджеры. Среди таких композитных менеджеров для Wayland можно отметить:</p>
<ol>
<li>Weston — эталонная реализация композитного менеджера Wayland;</li>
<li>Sway — аналог тайлинговых оконных менеджеров типа i3-wm для Wayland;</li>
<li>Mutter — из состава рабочего окружения GNOME;</li>
<li>KWin — из состава рабочего окружения KDE;</li>
</ol>
<p>Рассмотрим строение рабочего окружения на примере GNOME Shell:</p>
<ol>
<li>Дисплейный менеджер GDM;</li>
<li>Оконный/композитный менеджер Mutter;</li>
<li>Файловый менеджер Nautilus;</li>
<li>Оболочка GNOME Shell (включает в себя верхнюю панель с переключателем рабочих столов, часы и панель уведомлений, панель быстрых настроек, главное меню, dock со списком запущенных и закреплённых приложений, ряд диалогов и т.д.);</li>
</ol>
<p>Все компоненты рабочих окружений, как правило, тесно интегрированы друг с другом и составляют целую «экосистему» связанного друг с другом ПО.</p>
<p>Во встраиваемых системах как правило нет графического пользовательского окружения, поскольку такие окружения достаточно тяжёлые для слабого встраиваемого оборудования.</p>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>ровно поэтому нет и не может быть никаких «отечественных дистрибутивов Linux» или уж того хуже «отечественных операционных систем» (100% которых — просто дистрибутивы Linux, не более). Вклад российских разработчиков в развитие Linux ровно такой же, как и вклад любого другого разработчика из любого другого государства. Поэтому некорректно называть какой-то дистрибутив российским, французским, китайским и т.д.</p>
</div>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../additional/os-structure.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../additional/os-structure2.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../additional/os-structure.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../additional/os-structure2.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
